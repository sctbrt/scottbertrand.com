/* ============================================================
   Glass Material System — scottbertrand.com
   v1.6.0
   ------------------------------------------------------------
   Architectural, edge-led glass with balanced light/dark parity.
   Premium material feel without gimmicks.
   ============================================================ */

/* ------------------------------------------------------------
   1. Root Variables — Light Mode (Default)
   ------------------------------------------------------------ */

:root {
  /* Global light direction (normalized -1 → 1) */
  --glass-lx: 0.15;
  --glass-ly: -0.15;

  /* Core material — Light mode */
  --glass-blur-core: 20px;
  --glass-blur-edge: 24px;

  /* Fill: nearly invisible glass - just edge definition and blur
     Extremely low opacity for maximum translucency */
  --glass-bg: linear-gradient(
    180deg,
    rgba(255, 255, 255, 0.06) 0%,
    rgba(255, 255, 255, 0.02) 100%
  );
  --glass-bg-solid: rgba(255, 255, 255, 0.04);
  --glass-bg-fallback: rgba(250, 248, 243, 0.70);

  /* Borders: outer + inner stroke for plane definition */
  --glass-border-outer: rgba(0, 0, 0, 0.06);
  --glass-border-inner: rgba(255, 253, 248, 0.5);

  /* Specular highlight — top edge light catch (warm-tinted) */
  --glass-specular: rgba(255, 253, 248, 0.85);
  --glass-specular-width: 1px;

  /* Edge lighting (warm-tinted) */
  --glass-edge-highlight: rgba(255, 253, 248, 0.55);
  --glass-edge-shadow: rgba(0, 0, 0, 0.05);

  /* Shadow stack — soft lift, not aggressive */
  --glass-shadow:
    0 1px 2px rgba(0, 0, 0, 0.04),
    0 4px 12px rgba(0, 0, 0, 0.06),
    0 16px 40px rgba(0, 0, 0, 0.08);

  /* Micro-grain opacity */
  --glass-grain-opacity: 0.035;

  /* Radii */
  --glass-radius-sm: 12px;
  --glass-radius-md: 16px;
  --glass-radius-lg: 20px;

  /* Motion */
  --glass-transition-fast: 240ms cubic-bezier(0.25, 0.1, 0.25, 1);
  --glass-transition-slow: 420ms cubic-bezier(0.25, 0.1, 0.25, 1);
}

/* ------------------------------------------------------------
   2. Dark Mode Variables — Lighter, Airier
   ------------------------------------------------------------ */

[data-theme="dark"] {
  /* Fill: reduced opacity for airiness, subtle gradient */
  --glass-bg: linear-gradient(
    180deg,
    rgba(28, 28, 28, 0.45) 0%,
    rgba(22, 22, 22, 0.38) 100%
  );
  --glass-bg-solid: rgba(24, 24, 24, 0.42);
  --glass-bg-fallback: rgba(20, 20, 20, 0.75);

  /* Borders: subtle luminous edge, not heavy frame */
  --glass-border-outer: rgba(255, 255, 255, 0.08);
  --glass-border-inner: rgba(255, 255, 255, 0.04);

  /* Specular — restrained top edge glow */
  --glass-specular: rgba(255, 255, 255, 0.12);

  /* Edge lighting — reduced by ~40% from previous */
  --glass-edge-highlight: rgba(255, 255, 255, 0.10);
  --glass-edge-shadow: rgba(0, 0, 0, 0.20);

  /* Shadow stack — softer, less dense */
  --glass-shadow:
    0 1px 2px rgba(0, 0, 0, 0.15),
    0 4px 16px rgba(0, 0, 0, 0.20),
    0 12px 32px rgba(0, 0, 0, 0.15);

  /* Grain slightly more visible on dark */
  --glass-grain-opacity: 0.04;
}

/* ------------------------------------------------------------
   3. Base Glass Container
   ------------------------------------------------------------ */

.glass {
  position: relative;
  background: var(--glass-bg);
  border-radius: var(--glass-radius-md);
  border: 1px solid var(--glass-border-outer);
  box-shadow: var(--glass-shadow);
  overflow: hidden;

  /* Backdrop blur */
  backdrop-filter: blur(var(--glass-blur-core)) saturate(140%);
  -webkit-backdrop-filter: blur(var(--glass-blur-core)) saturate(140%);

  transition:
    background var(--glass-transition-slow),
    border-color var(--glass-transition-slow),
    box-shadow var(--glass-transition-slow);
}

/* Fallback when backdrop-filter is unsupported */
@supports not ((backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px))) {
  .glass {
    background: var(--glass-bg-fallback);
  }
}

/* ------------------------------------------------------------
   4. Edge-Led Refraction System
   ------------------------------------------------------------ */

.glass::before,
.glass::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events: none;
}

/* ::before — Inner stroke + specular highlight + edge glow */
.glass::before {
  /* Inner stroke for plane definition */
  border: 1px solid var(--glass-border-inner);
  /* Specular top-edge + directional highlight */
  box-shadow:
    inset 0 var(--glass-specular-width) 0 var(--glass-specular),
    inset calc(var(--glass-lx) * -3px)
          calc(var(--glass-ly) * -3px)
          12px
          var(--glass-edge-highlight);
}

/* ::after — Micro-grain texture overlay */
.glass::after {
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  background-size: 128px 128px;
  opacity: var(--glass-grain-opacity);
  mix-blend-mode: overlay;
}

/* Opposing shadow on a third pseudo would require extra markup,
   so we fold it into the box-shadow stack on .glass itself */

/* ------------------------------------------------------------
   5. Glass Variants
   ------------------------------------------------------------ */

/* Wide section divider / band */
.glass--band {
  border-radius: var(--glass-radius-lg);
  padding: 1.25rem 1.5rem;
}

/* Content container (case studies, offerings) */
.glass--panel {
  padding: 2.5rem 2rem 4rem 2rem;
}

/* Narrow editorial callout / system note */
.glass--callout {
  border-radius: var(--glass-radius-sm);
  padding: 1rem 1.25rem;
}

/* Footer / closing container */
.glass--footer {
  border-radius: var(--glass-radius-lg);
  padding: 2rem;
}

/* ------------------------------------------------------------
   6. Hero Glass — Prominent but Balanced
   ------------------------------------------------------------ */

.glass--hero {
  --glass-blur-core: 22px;
  border-radius: var(--glass-radius-lg);
  padding: 3rem 2.5rem;

  /* Fill container - width controlled by parent .container */
  width: 100%;
}

/* Hero-specific edge lighting — slightly stronger than base */
.glass--hero::before {
  box-shadow:
    inset 0 var(--glass-specular-width) 0 var(--glass-specular),
    inset calc(var(--glass-lx) * -4px)
          calc(var(--glass-ly) * -4px)
          16px
          var(--glass-edge-highlight);
}

/* Light mode hero enhancements */
:root .glass--hero {
  --glass-bg: linear-gradient(
    180deg,
    rgba(255, 255, 255, 0.75) 0%,
    rgba(255, 255, 255, 0.60) 100%
  );
  --glass-shadow:
    0 1px 3px rgba(0, 0, 0, 0.05),
    0 6px 20px rgba(0, 0, 0, 0.07),
    0 20px 50px rgba(0, 0, 0, 0.09);
}

/* Dark mode hero — lighter than before, same family as nav */
[data-theme="dark"] .glass--hero {
  --glass-bg: linear-gradient(
    180deg,
    rgba(30, 30, 30, 0.40) 0%,
    rgba(24, 24, 24, 0.35) 100%
  );
  --glass-border-outer: rgba(255, 255, 255, 0.09);
  --glass-specular: rgba(255, 255, 255, 0.14);
  --glass-edge-highlight: rgba(255, 255, 255, 0.08);
  --glass-shadow:
    0 1px 3px rgba(0, 0, 0, 0.12),
    0 6px 20px rgba(0, 0, 0, 0.18),
    0 16px 40px rgba(0, 0, 0, 0.12);
}

/* Dark mode hero specular — refined top-edge */
[data-theme="dark"] .glass--hero::before {
  box-shadow:
    inset 0 1px 0 var(--glass-specular),
    inset calc(var(--glass-lx) * -4px)
          calc(var(--glass-ly) * -4px)
          16px
          var(--glass-edge-highlight);
}

/* ------------------------------------------------------------
   7. Responsive Adjustments
   ------------------------------------------------------------ */

@media (max-width: 768px) {
  .glass--hero {
    padding: 2rem 1.5rem;
    border-radius: var(--glass-radius-md);
  }

  .glass--panel {
    padding: 1.5rem 1rem;
  }

  /* Reduce grain on mobile for cleaner look */
  :root {
    --glass-grain-opacity: 0.025;
  }
}

@media (max-width: 480px) {
  .glass--hero {
    padding: 1.5rem 1rem;
    border-radius: var(--glass-radius-sm);
  }

  /* Remove grain entirely on small screens */
  .glass::after {
    opacity: 0;
  }
}

/* ------------------------------------------------------------
   8. Reduced Motion Handling
   ------------------------------------------------------------ */

@media (prefers-reduced-motion: reduce) {
  .glass {
    transition: none;
  }
}

/* ------------------------------------------------------------
   9. Guardrails
   ------------------------------------------------------------ */

/* Never stack visual noise */
.glass > .glass {
  background: transparent;
  backdrop-filter: none;
  -webkit-backdrop-filter: none;
  box-shadow: none;
}

.glass > .glass::before,
.glass > .glass::after {
  display: none;
}
